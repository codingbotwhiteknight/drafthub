{% extends 'core/base2.html' %}
{% load drafthub_extras %}

{% block meta %}
  <title>{{ page_title }}</title>
  <meta name="title" content="{{ page_title }}">
  <meta name="description" content="{{ page_description }}">
  <meta name="author" content="{{ page_author }}">
  <meta name="keywords" content="{{ page_keywords }}">
  <meta property="og:type" content="website">
  <meta property="og:url" content="{{ page_url }}">
  <meta property="og:title" content="{{ page_title }}">
  <meta property="og:description" content="{{ page_description }}">
  <meta property="og:image" content="{{ page_image }}">
  <meta property="twitter:card" content="summary_large_image">
  <meta property="twitter:url" content="{{ page_url }}">
  <meta property="twitter:title" content="{{ page_title }}">
  <meta property="twitter:description" content="{{ page_description }}">
  <meta property="twitter:image" content="{{ page_image }}">
{% endblock meta %}



{% block breadcrumb %}
  <li><a aria-current="page" href="{% url 'home' %}">DRAFTHUB</a></li>
  <li class="is-hidden-mobile" aria-hidden="true"></li>
{% endblock breadcrumb %}

{% block start %}
  <div class="navbar-item">
    <searchform action="{% url 'search' %}" placeholder="Search"></searchform>
  </div>
{% endblock start %}


{% block main %}
  <section class="is-hidden-tablet" aria-labelledby="mostActiveTopicsMobile">
    <heading1 id="mostActiveTopicsMobile">Most active topics</heading1>
    {% for tag in tags_pop %}
      <p><a href="{{ tag.get_absolute_url }}">{{ forloop.counter }}. {{ tag }}</a></p>
    {% endfor %}
    <br>
    <br>
  </section>
  {% if page_obj.has_previous is False %}
  <section aria-labelledby="mostPopular">
  <heading1 id="mostPopular" >Most popular</heading1>
    {% for draft in drafts_pop %}
      <draftarticle
        title="{{ draft.title }}"
        href="{{ draft.get_absolute_url }}"
        author="{{ draft.blog }}"
        blog="{{ draft.blog.get_absolute_url }}"
        created="{{ draft.created|date:'M j' }}"
        updated="{{ draft.updated|timesince|timesince_format }}"
        datetime="{{ draft.created|date:'Y-m-d' }}"
        src="{{ draft.image }}">
        {% for tag in draft.tags.all %}
          <a rel="tag" href="{{ tag.get_absolute_url }}">#{{ tag }}</a>
        {% endfor %}
      </draftarticle>
    {% endfor %}
  <br>
  <br>
  </section>
  {% endif %}

  <section role="feed" aria-labelledby="latestArticle">
    <heading1 id="latestArticle">Latest articles</heading1>
    {% for draft in drafts_new %}
      <draftarticle
        title="{{ draft.title }}"
        href="{{ draft.get_absolute_url }}"
        author="{{ draft.blog }}"
        blog="{{ draft.blog.get_absolute_url }}"
        latest="{{ draft.created|timesince|timesince_format }}"
        src="{{ draft.image }}">
        {% for tag in draft.tags.all %}
          <a rel="tag" href="{{ tag.get_absolute_url }}">#{{ tag }}</a>
        {% endfor %}
      </draftarticle>
    {% endfor %}
    <br>
    <br>
    <nav
      style="justify-content:center"
      class="pagination"
      aria-label="pagination">
      {% if page_obj.has_previous %}
        <a rel="prev" href="?page={{ page_obj.previous_page_number }}" class="pagination-previous px-2">Previous</a>
      {% endif %}

      {% if page_obj.has_next %}
        <a rel="next" href="?page={{ page_obj.next_page_number }}" class="pagination-next px-2">Next</a>
      {% endif %}
    </nav>
  </section>

{% endblock main %}

{% block aside %}
  <section aria-labelledby="mostActiveTopics">
    <heading1 id="mostActiveTopics">Most active topics</heading1>
    {% for tag in tags_pop %}
      <p><a href="{{ tag.get_absolute_url }}">{{ forloop.counter }}. {{ tag }}</a></p>
    {% endfor %}
  </section>
  <br>
  <br>

  <section aria-labelledby="lastUpdated">
    <heading1 id="lastUpdated">Last updated</heading1>
    {% for draft in drafts_updated %}
      <draftarticle
        title="{{ draft.title }}"
        href="{{ draft.get_absolute_url }}"
        author="{{ draft.blog }}"
        blog="{{ draft.blog.get_absolute_url }}"
        latest="{{ draft.updated|timesince|timesince_format }}"
        tiny="true"
        src="{{ draft.image }}">
        {% for tag in draft.tags.all %}
          <a rel="tag" href="{{ tag.get_absolute_url }}">#{{ tag }}</a>
        {% endfor %}
      </draftarticle>
    {% endfor %}
  </section>
  <br>
  <br>

  <section aria-labelledby="lastChanceToRead">
    <heading1 id="lastChanceToRead">Last chance to read</heading1>
    {% for draft in drafts_random %}
      <draftarticle
        title="{{ draft.title }}"
        href="{{ draft.get_absolute_url }}"
        author="{{ draft.blog }}"
        blog="{{ draft.blog.get_absolute_url }}"
        created="{{ draft.created|date:'M j'}}"
        updated="{{ draft.updated|timesince|timesince_format }}"
        tiny="true"
        src="{{ draft.image }}">
        {% for tag in draft.tags.all %}
          <a rel="tag" href="{{ tag.get_absolute_url }}">#{{ tag }}</a>
        {% endfor %}
      </draftarticle>
    {% endfor %}
  </section>
{% endblock aside %}

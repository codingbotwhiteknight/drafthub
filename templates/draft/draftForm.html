<form
  action=""
  method="POST"
  autocomplete="off"
  @keydown.enter.prevent>
  {% csrf_token %}

  <b-field
    message="* Must be a .md file from your GitHub"
    label="Markdown url"
    :type="{'is-danger': newArticle.formError.url}">
    <b-input
      @input.once="newArticle.formError.url=false"
      :value="newArticle.url"
      @change.native="newArticle.url = $event.target.value"
      name="github_url"
      type="url"
      :use-html5-validation="false"
      autocomplete="off">
    </b-input>
    <template v-if="newArticle.formError.url" slot="message">
      {{ form.github_url.errors }}
    </template>
  </b-field>

  <b-field label="Cover image url" :type="{'is-danger': newArticle.formError.image}">
    <b-input 
      @input.once="newArticle.formError.image=false"
      :value="newArticle.image"
      @change.native="newArticle.image = $event.target.value"
      name="image"
      type="url"
      :use-html5-validation="false"
      autocomplete="off">
    </b-input>
    <template v-if="newArticle.formError.image" slot="message">
      {{ form.image.errors }}
    </template>
  </b-field>
  <coverpreview :src="newArticle.image"></coverpreview>

  <b-field label="Title" :type="{'is-danger': newArticle.formError.title}">
    <b-input
      @input="newArticle.formError.title=false"
      v-model="newArticle.title"
      maxlength="{{ form.fields.title.max_length }}"
      autocomplete="off"
      name="title"
      type="text">
    </b-input>
    <template v-if="newArticle.formError.title" slot="message">
      {{ form.title.errors }}
    </template>
  </b-field>

  <b-field label="Description" :type="{'is-danger': newArticle.formError.description}">
    <b-input
      @input.once="newArticle.formError.description=false"
      v-model="newArticle.description"
      maxlength="{{ form.fields.description.max_length }}"
      name="description"
      type="textarea"
      rows="7"
      autocomplete="off">
    </b-input>
    <template v-if="newArticle.formError.description" slot="message">
      {{ form.description.errors }}
    </template>
  </b-field>

  <b-field
    label="Tags"
    :type="{'is-danger': newArticle.formError.tags}">
    <inputtags
      @input.once="newArticle.formError.tags=false"
      :api="newArticle.apiTags"
      name="tags"
      v-model="newArticle.tags">
    </inputtags>
    <template v-if="newArticle.formError.tags" slot="message">
      {{ form.tags.errors }}
    </template>
  </b-field>

  <p class="control pt-3">
    <button class="button is-dark is-fullwidth">Publish</button>
  </p>
</form>
